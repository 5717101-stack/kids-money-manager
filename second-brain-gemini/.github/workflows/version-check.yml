name: ðŸ” Version Check

on:
  push:
    branches:
      - main
    paths:
      - 'VERSION'
  pull_request:
    paths:
      - 'VERSION'

jobs:
  check-version:
    name: Check Version Format
    runs-on: ubuntu-latest
    
    steps:
      - name: ðŸ“¥ Checkout code
        uses: actions/checkout@v4
      
      - name: ðŸ“ Read version
        id: version
        run: |
          if [ ! -f VERSION ]; then
            echo "âŒ VERSION file not found!"
            exit 1
          fi
          
          VERSION=$(cat VERSION | tr -d '[:space:]')
          
          # Check version format (semantic versioning: X.Y.Z)
          if [[ ! $VERSION =~ ^[0-9]+\.[0-9]+\.[0-9]+$ ]]; then
            echo "âŒ Invalid version format: $VERSION"
            echo "Expected format: X.Y.Z (e.g., 1.7.1)"
            exit 1
          fi
          
          echo "version=$VERSION" >> $GITHUB_OUTPUT
          echo "âœ… Version format is valid: $VERSION"
      
      - name: ðŸ“Š Version Info
        run: |
          echo "## ðŸ“Œ Version Information" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "**Current Version:** ${{ steps.version.outputs.version }}" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "âœ… Version format is valid!" >> $GITHUB_STEP_SUMMARY
